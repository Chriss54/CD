---
phase: 13-search-ui
plan: 03
type: execute
wave: 2
depends_on: [13-01, 13-02]
files_modified:
  - src/components/layout/header.tsx
autonomous: false

must_haves:
  truths:
    - "User can access search from persistent search bar in header"
    - "Search bar is visible on all authenticated pages"
    - "Typing query and pressing enter navigates to /search?q={query}"
    - "Cmd+K / Ctrl+K keyboard shortcut focuses the search bar"
  artifacts:
    - path: "src/components/layout/header.tsx"
      provides: "Header with integrated SearchBar"
      contains: "SearchBar"
  key_links:
    - from: "src/components/layout/header.tsx"
      to: "src/components/search/search-bar.tsx"
      via: "import and render"
      pattern: "import.*SearchBar.*from.*search"
---

<objective>
Integrate the SearchBar component into the site header, making search accessible from all authenticated pages.

Purpose: Complete the search UI by placing the search bar in its permanent location in the header.
Output: Header displays search bar, completing the search UI implementation.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-search-ui/13-CONTEXT.md
@.planning/phases/13-search-ui/13-01-SUMMARY.md
@.planning/phases/13-search-ui/13-02-SUMMARY.md
@src/components/layout/header.tsx
@src/components/search/search-bar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Integrate SearchBar into Header</name>
  <files>src/components/layout/header.tsx</files>
  <action>
    Add the SearchBar component to the existing Header:

    1. Import SearchBar from '@/components/search/search-bar'
    2. Place SearchBar in the header between the logo/name and UserMenu
    3. SearchBar is a Client Component, but it can be imported into a Server Component (Client Components can be children of Server Components)

    Current header structure:
    ```tsx
    <header className="...">
      <div className="flex items-center gap-3">
        {/* Logo and name */}
      </div>
      <div className="flex items-center gap-4">
        <UserMenu />
      </div>
    </header>
    ```

    Updated structure:
    ```tsx
    <header className="...">
      <div className="flex items-center gap-3">
        {/* Logo and name */}
      </div>
      <div className="flex items-center gap-4">
        <SearchBar />
        <UserMenu />
      </div>
    </header>
    ```

    The SearchBar should appear to the left of the UserMenu, providing a natural flow from search to user actions.

    No other changes needed - the Header remains a Server Component. Client Components can be imported and rendered as children of Server Components without any special handling.
  </action>
  <verify>
    1. Header imports SearchBar
    2. SearchBar renders between logo and UserMenu
    3. TypeScript compiles: `npx tsc --noEmit`
    4. Dev server shows SearchBar in header
  </verify>
  <done>SearchBar is visible in header on all authenticated pages</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete search UI implementation: SearchBar in header, search results page with type filtering, empty/no-results states</what-built>
  <how-to-verify>
    1. Start dev server: `npm run dev`
    2. Navigate to any authenticated page (e.g., /feed)
    3. Verify search bar is visible in the header
    4. Press Cmd+K (Mac) or Ctrl+K (Windows) - search bar should focus
    5. Type a search term and press Enter
    6. Verify navigation to /search?q={query}
    7. Check that results display with type tabs
    8. Click a type tab (Posts, Members, Courses) and verify URL updates
    9. Verify filtered results show only that type
    10. Test empty states:
        - Navigate to /search (no query) - should show placeholder
        - Search for gibberish like "xyzabc123nonsense" - should show "No results" message
    11. Click on a search result and verify navigation to the correct page
    12. Verify matched text in snippets has yellow highlight
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
Phase 13 complete when:
1. SearchBar visible in header on all authenticated pages
2. Cmd+K / Ctrl+K focuses search bar
3. Form submit navigates to /search?q={query}
4. Results page displays with type tabs
5. Type filtering works via URL params
6. Empty and no-results states display correctly
7. Results link to correct destinations
8. Snippets show highlighted matches
</verification>

<success_criteria>
All Phase 13 requirements met:
- SRCH-04: User can access search from persistent search bar in header
- SRCH-05: User can search across posts, members, and courses from single input
- SRCH-06: User sees search results page at /search?q={query}
- SRCH-07: User can filter results by content type (All, Posts, Members, Courses)
- SRCH-08: Results show relevant snippet with matched text context
- SRCH-10: User can click result to navigate to full content
- SRCH-11: Empty search shows placeholder prompting user to enter query
- SRCH-12: No results state shows helpful suggestions
</success_criteria>

<output>
After completion, create `.planning/phases/13-search-ui/13-03-SUMMARY.md`
</output>
