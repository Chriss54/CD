---
phase: 07-classroom-experience
plan: 02
type: execute
wave: 2
depends_on: ["07-01"]
files_modified:
  - src/app/(main)/classroom/page.tsx
  - src/components/classroom/course-catalog-card.tsx
  - src/components/classroom/course-catalog-grid.tsx
  - src/components/classroom/progress-bar.tsx
  - src/components/classroom/enrolled-course-card.tsx
autonomous: true

must_haves:
  truths:
    - "User can view course catalog with published courses"
    - "Catalog shows course cards in responsive grid (1-3 columns)"
    - "Each card shows title, description preview, lesson count"
    - "Enrolled courses show progress bar"
    - "Empty state displays when no courses available"
  artifacts:
    - path: "src/app/(main)/classroom/page.tsx"
      provides: "Course catalog page with enrolled and available sections"
      min_lines: 40
    - path: "src/components/classroom/course-catalog-card.tsx"
      provides: "Card component for unenrolled courses in catalog"
      exports: ["CourseCatalogCard"]
    - path: "src/components/classroom/enrolled-course-card.tsx"
      provides: "Card component with progress bar for enrolled courses"
      exports: ["EnrolledCourseCard"]
    - path: "src/components/classroom/progress-bar.tsx"
      provides: "Reusable accessible progress bar"
      exports: ["ProgressBar"]
  key_links:
    - from: "src/app/(main)/classroom/page.tsx"
      to: "getPublishedCourses"
      via: "server component data fetch"
      pattern: "getPublishedCourses|getEnrolledCoursesWithProgress"
    - from: "src/components/classroom/enrolled-course-card.tsx"
      to: "/classroom/courses/[courseId]"
      via: "Link component"
      pattern: "href=.*classroom/courses"
---

<objective>
Create the course catalog page where users can browse available courses and see their enrolled courses with progress.

Purpose: Enable users to discover and access courses (CLRM-06). This is the entry point to the classroom experience.
Output: Functional catalog page with responsive grid, progress indicators, and proper empty states.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/07-classroom-experience/07-CONTEXT.md
@.planning/phases/07-classroom-experience/07-RESEARCH.md
@.planning/phases/07-classroom-experience/07-01-SUMMARY.md
@src/components/profile/member-grid.tsx
@src/components/profile/member-card.tsx
@src/components/ui/empty-state.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ProgressBar and card components</name>
  <files>
    src/components/classroom/progress-bar.tsx
    src/components/classroom/course-catalog-card.tsx
    src/components/classroom/enrolled-course-card.tsx
  </files>
  <action>
Create the components directory and three components:

**1. progress-bar.tsx** - Accessible progress bar (no percentage label per CONTEXT.md):
```typescript
interface ProgressBarProps {
  value: number; // 0-100
  className?: string;
}
```
- Use div-based implementation (more flexible than native progress element)
- Include ARIA attributes: role="progressbar", aria-valuenow, aria-valuemin=0, aria-valuemax=100, aria-label
- Green fill color (bg-green-500), gray track (bg-gray-200)
- Rounded full, h-2 height
- Clamp value between 0-100
- Smooth transition on width change (transition-all duration-300)

**2. course-catalog-card.tsx** - Card for unenrolled courses:
```typescript
interface CatalogCourse {
  id: string;
  title: string;
  description: string | null;
  lessonCount: number;
}
```
- Link wrapper to `/classroom/courses/${course.id}`
- Card styling matching existing patterns (rounded-lg, border, hover shadow)
- Title (font-semibold, truncate if long)
- Description preview (text-sm, text-muted-foreground, line-clamp-2)
- Lesson count badge at bottom (e.g., "12 lessons")
- No thumbnail for now (per RESEARCH.md open question - use placeholder or skip)

**3. enrolled-course-card.tsx** - Card with progress for enrolled courses:
```typescript
interface EnrolledCourse {
  id: string;
  title: string;
  description: string | null;
  progressPercent: number;
  completedLessons: number;
  totalLessons: number;
  nextLessonId: string | null;
}
```
- Similar structure to catalog card
- Add ProgressBar component at bottom
- Add "Continue Learning" button if nextLessonId exists (links to lesson page)
- Show "x/y lessons" text near progress bar
- If 100% complete, show "Completed" badge instead of Continue button
  </action>
  <verify>Components render without errors. TypeScript compiles. Progress bar is accessible (check with browser dev tools accessibility panel).</verify>
  <done>Three reusable components created for catalog display.</done>
</task>

<task type="auto">
  <name>Task 2: Create course catalog grid component</name>
  <files>src/components/classroom/course-catalog-grid.tsx</files>
  <action>
Create grid container component following MemberGrid pattern:

```typescript
interface CourseCatalogGridProps {
  courses: CatalogCourse[];
  emptyMessage?: string;
}
```

- Check if courses array is empty, show EmptyState component with:
  - title: "No courses available"
  - description: "Check back soon for new courses."
  - Optional icon (book or graduation cap SVG)
- If courses exist, render responsive grid:
  - grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6
  - Map over courses, render CourseCatalogCard for each

Also create EnrolledCoursesGrid for the "My Courses" section:
```typescript
interface EnrolledCoursesGridProps {
  courses: EnrolledCourse[];
}
```
- Similar structure but uses EnrolledCourseCard
- Different empty state: "You haven't enrolled in any courses yet."
  </action>
  <verify>Grid renders correctly with 0, 1, 2, and 3+ courses. Responsive breakpoints work.</verify>
  <done>Grid components handle empty states and responsive layout.</done>
</task>

<task type="auto">
  <name>Task 3: Update classroom page with real catalog</name>
  <files>src/app/(main)/classroom/page.tsx</files>
  <action>
Replace the placeholder classroom page with a real catalog:

1. Make it an async Server Component
2. Get user session with getServerSession(authOptions)
3. Fetch data:
   - If logged in: getEnrolledCoursesWithProgress(userId) from enrollment-actions
   - getPublishedCourses() - new function to add to enrollment-actions.ts or course-actions.ts

4. Create getPublishedCourses server action if not exists:
   - Query courses where status: 'PUBLISHED'
   - Include count of published lessons (through modules)
   - Return array of { id, title, description, lessonCount }

5. Page structure:
   - Page title: "Classroom"
   - If logged in, show "My Courses" section first:
     - EnrolledCoursesGrid with enrolled courses
     - Or empty state if none enrolled
   - "Available Courses" section:
     - Filter out already-enrolled courses from published list
     - CourseCatalogGrid with remaining courses
   - If not logged in, show all published courses with a banner encouraging sign-in

6. Use Suspense boundaries around data-fetching sections for streaming
  </action>
  <verify>Page loads without errors. Shows enrolled courses with progress bars. Shows available courses. Empty states work correctly.</verify>
  <done>Classroom page displays real course data with enrolled/available sections.</done>
</task>

</tasks>

<verification>
Manual testing checklist:

1. Visit /classroom as logged-in user
   - [ ] Page loads without errors
   - [ ] "My Courses" section visible (may be empty)
   - [ ] "Available Courses" shows published courses
   - [ ] Cards display title, description, lesson count

2. Enroll in a course (manually in DB or via later plan)
   - [ ] Course appears in "My Courses"
   - [ ] Progress bar shows 0%
   - [ ] "Continue Learning" button visible

3. Responsive design
   - [ ] 1 column on mobile
   - [ ] 2 columns on tablet
   - [ ] 3 columns on desktop

4. Empty states
   - [ ] No courses: proper empty state message
   - [ ] No enrollments: "You haven't enrolled" message

```bash
# Build check
npm run build

# Type check
npx tsc --noEmit
```
</verification>

<success_criteria>
- Catalog page shows all published courses in responsive grid
- Enrolled courses section shows courses with progress bars
- Progress bar is accessible (ARIA attributes present)
- Empty states display appropriate messages
- Cards link to course detail pages
- "Continue Learning" button appears for in-progress courses
- Page uses Server Components for data fetching
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/07-classroom-experience/07-02-SUMMARY.md`
</output>
